<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>

	<meta charset="UTF-8">
	<title>Build Tellurium Plugins from Source</title>
	
<link rel='stylesheet' id='wp-quicklatex-format-css'  href='http://libroadrunner.org/wp-content/plugins/wp-quicklatex/css/quicklatex-format.css?ver=3.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-widgets-css'  href='http://libroadrunner.org/wp-content/plugins/jetpack/modules/widgets/widgets.css?ver=20121003' type='text/css' media='all' />
<!-- <link rel='stylesheet' id='twentythirteen-fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&#038;subset=latin%2Clatin-ext' type='text/css' media='all' /> -->
<link rel='stylesheet' id='genericons-css'  href='http://libroadrunner.org/wp-content/plugins/jetpack/_inc/genericons/genericons.css?ver=3.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-style-css'  href='http://libroadrunner.org/wp-content/themes/twentythirteen/style.css?ver=2013-07-18' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentythirteen-ie-css'  href='http://libroadrunner.org/wp-content/themes/twentythirteen/css/ie.css?ver=2013-07-18' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" type="text/css" href="../../css/plugin_table.css"/> 
	</head>

<body class="home page page-id-5 page-template-default single-author">
					<div class="entry-content">
						<h1>Build Tellurium Plugins from Source</h1>
						<h3>Intro</h3>
<p>This document shows how to build Tellurium Plugins from sources using Visual Studio 2010 and above. The plugin requires a full build of libRoadRunner as well as third party libraries.</p>

<h3>1. Building libRoadRunner</h3>
<p>The Tellurium plugins depend on a compatible libRoadRunner installation.<br><br> 
Follow the instruction on <a href="http://libroadrunner.org/build-roarunner-from-source/">libRoadRunner website</a> to build libRoadRunner from the source.

<br><br>
<b>Note: </b> In the following instruction we will create a <i>release</i> type of build. This requires libRoadRunner and all of its dependencies to be built as <i>release</i> builds as well.

<br> <br>

<h3>2. Acquire the source code for Tellurium plugins </h3>

The source code for Tellurium Plugins is located on <a href="https://github.com/sys-bio/telPlugins">GitHub</a> with the address:

<br>
<blockquote>
<code>
https://github.com/sys-bio/telPlugins.git
</code>
</blockquote>

Any standard git client can be used to clone the repository. From the command line, type: <br>
<blockquote>
<code>
    git clone https://github.com/sys-bio/telPlugins.git
</code>
</blockquote>
A successful clone will have similar folder structure as shown below.
<br><br>

<figure>
<img src="source_tree.jpg" />
<figcaption>Figure 1. The Tellurium Plugins source tree.</figcaption>
</figure>
<br>

<h3>3. Generate Solution Files </h3>
Solution files are generated using CMake. You can download CMake from <a href="http://www.cmake.org/cmake/resources/software.html">CMake website.</a> A complete set of build files for the Plugins and the Plugin APIs includes:
<ul>
    <li> Visual Studio solution files for the Plugin APIs </li>
    <li> Visual Studio solution files for Plugin Third Parties </li>
</ul>

<p>
Following steps will show how to create a solution file for the Plugins using the CMake client for windows. When you start the CMake client for the first time, you will be presented with a blank screen.
</p>
<figure>
<img src="blank_cmake.jpg" />
<figcaption>Figure 2: CMake client for Windows.</figcaption>
</figure>
<br>
Click <b>Browse Source</b> and locate the folder for the cloned Tellurium Plugins source code. After you have selected the proper folder, click OK.

<figure>
<img src="blank_browse.jpg" />
<figcaption>Figure 3: The CMake 'Browse for folder' window.</figcaption>
</figure>

<br>
Next, click <b>Browse Build</b>. It will open another 'Browse for folder' window. The folder you select here will contain solution files after the build process is complete.
We will use the path <b>'r:/builds/plugins'</b> as an example in this instruction.

<figure>
<img src="build_browse.jpg" />
<figcaption>Figure 4: The CMake 'Browse for folder' window. The figure shows how the folder <b>'r:/builds/plugins'</b> has been selected. </figcaption>
</figure>
<br>

<p>After selecting the folders, CMake will present an empty window as shown below.</p>
<figure>
<img src="cmake_empty.jpg" />
<figcaption>Figure 5: CMake window after source and build folders have been selected. </figcaption>
</figure>
<br>


<p> Click <b>Configure</b>. If this is your first time using CMake, CMake will ask you for compiler to generate build files for.
For this instruction, we will select Visual Studio 10, which is the version number of Visual Studio 2010. Keep in mind that version numbers are not always intuitive, i.e. Visual Studio 2012 is Visual Studio 11. After selecting the compiler, click 'Finish'.</p>


<figure>
<img src="compiler_selection.jpg" />
<figcaption>Figure 6: CMake's dialog box for compilers. </figcaption>
</figure>
<br>

<p>After selecting compiler, CMake will do some checks and then come back with various options, which are highlighted in red color. 
There are few important fields to setup correctly to obtain a successful build.</p>

<p>Set 'CMAKE_INSTALL_PREFIX' to be the <b>EXACT SAME</b> with the path used in building libRoadRunner. This field sets the path which the resulting binaries of the build will be placed. For this instruction, we used <b>'r:\plugins_install\release'</b>.
</p>
<p>Set 'THIRD_PARTY_INSTALL_FOLDER' to be the <b>EXACT SAME</b> with 'CMAKE_INSTALL_PREFIX'. </P>
<p>Set 'CMAKE_BUILD_TYPE' as 'Release'.</p>


<p>
The rest of the options are somewhat self-explanatory. Select which plugins you want to build by checking/unchecking the check boxes. When you have made the changes, click 'Configure'.
At this point, CMake window should resemble the figure below.
</p>

<figure>
<img src="cmake_selected.jpg" />
<figcaption>Figure 7: CMake window after modifications. </figcaption>
</figure>

<br>
<p>After a successful build, we may want to check the integrity of the build with some examples. Select <b>INSTALL_EXAMPLES</b> to generate example files.
Doing so will generate new options in the CMake window, as shown in the figure below.
<figure>
<img src="cmake_select_python_examples.jpg" />
<figcaption>Figure 8: Figure showing CMake's window after selecting the 'INSTALL_EXAMPLES' option and hitting the 'Generate' button.</figcaption>
</figure>


<br>
<p>Finally, click <b>Generate</b>. This step will generate the Visual Studio solution and other files necessary for Visual Studio to compile the source. Make sure there are no red fields left in the window.</p>
You will find the Visual Studio solution file called <b>tellurium.sln</b> in the path you selected before.

<figure>
<img src="cmake_after_generate.jpg" />
<figcaption>Figure 9: Figure showing CMake's window after that the 'Generate' button been clicked.</figcaption>
</figure>


<h5>Create solution files for Third Party libraries</h5>
<p>The Tellurium plugins source contains a sub-folder called 'third_parties'. This folder contains third party libraries that need to be built and installed <b>BEFORE</b> the plugins are built. Currently
the only necessary third party library is 'poco'. </p>

<p>The following steps show how to build the source code found in the third_parties folder.

First select the folder for the plugins third_party sources. In our example we used <b>r:\telPlugins\third_party\poco</b>. </p>

<p>Next, select the output folder for build files. In our example we used <b>r:\builds\plugins_third_party</b>. Then, within CMake, set CMAKE_INSTALL_PREFIX to point to the same path as other builds, i.e. <b>r:\plugins_install\release</b>.</p> 

<p>Finally, click <b>Generate</b>.</P>

<p>At this point, your CMake window should look like the figure below.</p>
<figure>
<img src="cmake_plugins_third_party_after_generate.jpg" />
<figcaption>Figure 10: Figure showing CMake's window after generating build files for the third party libraries. </figcaption>
</figure>



<h3>4. Build Tellurium plugins using Visual Studio </h3>


<p>We are now ready to build the plugins. The first step is to build the plugins third parties.</p>
<h5>Build Plugins Third Parties</h5>
<p>Open Visual Studio and select File->Open to browse the third party solution file. The third party solution file is called <b>poco.sln</b>. 
After loading this file into Visual Studio, the Visual Studio workspace should look similar to the figure below.

<figure>
<img src="vs_third_party_build_1.jpg" />
<figcaption>Figure 11: Figure showing Visual Studio 2010 after loading plugins third party solution file. </figcaption>
</figure>

<p>Next, if you see <b>Debug</b> in the drop down menu on the top, change it to <b>Release</b>.</p>
<p>
Right click on the <b>INSTALL</b> target and select Build (see figure below). This will start the compiling process.
<figure>
<img src="vs_third_party_build_2.jpg" />
<figcaption>Figure 12: Right clicking on 'INSTALL' and selecting build starts the build process for plugins third party library. </figcaption>
</figure>

<br>
<p> After a successful build, the Output window in Visual Studio will show a list of installed files as shown below:</p>

<figure>
<img src="vs_third_party_build_3.jpg" />
<figcaption>Figure 13: Output window in Visual Studio showing a successful build of plugins third party library. </figcaption>
</figure>

<h5>Build Plugins</h5>
<p>Open Visual Studio and select Tellurium Plugins solution file called <b>tellurium.sln</b>. Again, select the solution type to be <b>Release</b>.</p>

<figure>
<img src="vs_third_party_build_4.jpg" />
<figcaption>Figure 14: Visual Studio workspace for Tellurium Plugins. </figcaption>
</figure>

<p>Right click on the <b>INSTALL</b> target and select Build to start the compiling process.</p>


<p> After a successful build, the Visual Studio workspace should look like the figure below.  
</p>

<figure>
<img src="vs_plugins_build.jpg" />
<figcaption>Figure 15: Visual Studio workspace after building Tellurium Plugins. </figcaption>
</figure>



<h3>Optional: Verify the build</h3>
<p>It is always recommended to verify the integrity of the build. To check that the plugins are properly built, run <b>install_tellurium_plugins.py</b> script, located in the install folder. Keep in mind that this requires a functioning Python environment.</p>

<b>install_tellurium_plugins.py</b> installs the Python modules for Tellurium Plugins to Python's <i>site-packages</i> folder, allowing you to access plugins from Python environment.

The following figure shows the output from running the install script from PyScripter Python UI.

<figure>
<img src="install_plugins.jpg" />
<figcaption>Figure 16: Running install_tellurium_plugins.py script will copy necessary files into a users 'site-packages' folder.</figcaption>
</figure>
<br>
<p>Below is the typical output of telLevenbergMarquardt.py, an example script utilizing Levenberg-Marquardt plugin, which can be executed using Python.</p>

<figure>
<img src="python_example_1.jpg" />
<figcaption>Figure 17: Running a Python example using Levenberg-Marquardt plugin. </figcaption>
</figure>


<h3>Optional: Create a Python release</h3>
<p>To bundle the resulting build into a <i>Python Release</i>, run the shell script located <b>above</b> the actual install folder. 
The script is called <i>createPythonRelease.sh</i>. Executing the script will create a zip file containing all the necessary files for Python distribution. 

The figure below shows the folders and files created after <i>createPythonRelease.py</i> is executed.</p>
<figure>
<img src="python_release.jpg" />
<figcaption>Figure 18: After running the <i>createPythonRelease.py</i> script, a new folder called <i>PythonRelease</i> and a zip file are created which contain files necessary for Python distribution.</figcaption>
</figure>
<br>
</body>
</html>
